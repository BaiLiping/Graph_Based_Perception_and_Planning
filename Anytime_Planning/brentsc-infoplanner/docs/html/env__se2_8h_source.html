<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Information Gathering Library: include/igl/env/env_se2.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Information Gathering Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_d8545396a5fca4e99647f9a67174521c.html">igl</a></li><li class="navelem"><a class="el" href="dir_04f8bc34e81526b1da7bef23a3bd1821.html">env</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">env_se2.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Created by brent on 4/24/17.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#ifndef NX_ASTAR_ENV_TARGET_SE2_H</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#define NX_ASTAR_ENV_TARGET_SE2_H</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span>   <span class="comment">// std::unique_ptr</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span>      <span class="comment">// std::pair</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;igl/env/env_int.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;igl/mapping/map_nx.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;igl/control/motion_primitive.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;igl/control/dd_motion_model.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;igl/se3_pose.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacenx.html">nx</a> {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="classnx_1_1SE2Environment.html">   19</a></span>&#160;<span class="keyword">class </span><a class="code" href="classnx_1_1SE2Environment.html">SE2Environment</a> : <span class="keyword">public</span> <a class="code" href="classnx_1_1Environment.html">Environment</a>&lt;SE3Pose&gt; {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> goal_coord;     <span class="comment">// discrete coordinates of the goal node</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structnx_1_1MotionPrimitive.html">MotionPrimitive&lt;std::array&lt;double, 3&gt;</a>, std::array&lt;double, 2&gt;&gt; <a class="code" href="structnx_1_1MotionPrimitive.html">MPrim</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">size_t</span> max_len_traj_ = 0;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">double</span> samp = 0.5; <span class="comment">// TODO Correct this for usage with motion primitives</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> yaw_discretization_size = 60; <span class="comment">// Discretize the interval [-pi, pi].</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">double</span> yaw_res = 2 * PI / yaw_discretization_size;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">bool</span> is_3d; <span class="comment">// Check if collision checking should be done in 3D.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">// for each orientation</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">//   for each motion primitive</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">//     for each segment</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">//      we have a vector of micro states (discrete coordinates)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;std::array&lt;int, 3&gt;&gt;&gt;&gt;&gt; mprim_xd_;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classnx_1_1SE2Environment.html">SE2Environment</a>(std::shared_ptr&lt;nx::map_nd&gt; map_in,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                 std::shared_ptr&lt;std::vector&lt;char&gt;&gt; cmap_ptr,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                 <span class="keyword">const</span> std::string &amp;mprim_yaml,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                 <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> goal = <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a>())</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      : <a class="code" href="classnx_1_1Environment.html#a23652067c6e2c838b7e895ada850fa6b">Environment</a>(map_in, cmap_ptr, goal) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Initialize motion primitives</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    nx::mprmsFromYAML&lt;std::array&lt;double, 3&gt;, std::array&lt;double, 2&gt;&gt;(mprim_yaml,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                                                    <span class="keyword">static_cast&lt;</span>std::array&lt;double, 3&gt; (*)(</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                                                        <span class="keyword">const </span>std::array&lt;double, 3&gt; &amp;,</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                                        <span class="keyword">const </span>std::array&lt;double, 2&gt; &amp;,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                                        <span class="keywordtype">double</span>)<span class="keyword">&gt;</span>(nx::dd_motion_model),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                                    std::array&lt;double, 3&gt;({0, 0, 0}), mprim_,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                                    samp);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Check if this is a 3D Map or not.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    is_3d = map_in-&gt;res().size() == 3;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//                std::cout &lt;&lt;&quot;Motion Primitives &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//                for( int mp = 0; mp &lt; mprim_.size(); ++mp)</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//                  for( int l = 0; l &lt; mprim_[mp].xVecVec.size(); ++l )</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//                    for( int m = 0; m &lt; mprim_[mp].xVecVec[l].size(); ++m )</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//                      std::cout &lt;&lt; mprim_[mp].xVecVec[l][m][0] &lt;&lt; &quot; &quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//                                &lt;&lt; mprim_[mp].xVecVec[l][m][1] &lt;&lt; &quot; &quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//                                &lt;&lt; mprim_[mp].xVecVec[l][m][2] &lt;&lt; std::endl;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//                  std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//                  std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// compute discrete coordinates for each orientation</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    init_mprim_xd_();</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tr = 0; tr &lt; mprim_.size(); ++tr)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">if</span> (mprim_[tr].uVec.size() &gt; max_len_traj_)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        max_len_traj_ = mprim_[tr].uVec.size();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classnx_1_1SE2Environment.html#a0fe7c5f438795a98f17be0ed95b2ff7c">   78</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classnx_1_1SE2Environment.html#a0fe7c5f438795a98f17be0ed95b2ff7c">state_to_idx</a>(<span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp;state)<span class="keyword"> const override </span>{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// First we convert the XYZ position to cell coordinates.</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    std::vector&lt;int&gt; cell = <a class="code" href="classnx_1_1SE2Environment.html#ae3ac780e46d421898e3c7db696d8026f">state_to_cell</a>(state);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> map-&gt;subv2ind_colmajor(cell);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classnx_1_1SE2Environment.html#ab1f9056e6fffe905ec225ee3885679b4">   85</a></span>&#160;  Vector3d <a class="code" href="classnx_1_1SE2Environment.html#ab1f9056e6fffe905ec225ee3885679b4">state_to_SE2</a>(<span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp;state)<span class="keyword"> const override </span>{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> state.<a class="code" href="structnx_1_1SE3Pose.html#a1796e8aafcf90da2e6b0d07ca4c7135f">getSE2</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classnx_1_1SE2Environment.html#ae3ac780e46d421898e3c7db696d8026f">   89</a></span>&#160;  std::vector&lt;int&gt; <a class="code" href="classnx_1_1SE2Environment.html#ae3ac780e46d421898e3c7db696d8026f">state_to_cell</a>(<span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp;state)<span class="keyword"> const override </span>{</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    Vector3d position = state.position;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> map-&gt;meters2cells({position[0], position[1], position[2]});</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classnx_1_1SE2Environment.html#a2a4159dc6bf024e522bb504c77e9aa69">   94</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classnx_1_1SE2Environment.html#a2a4159dc6bf024e522bb504c77e9aa69">get_succ</a>(<span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp;curr,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                       std::vector&lt;SE3Pose&gt; &amp;succ,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                       std::vector&lt;int&gt; &amp;succ_idx,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                       std::vector&lt;double&gt; &amp;succ_cost,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                       std::vector&lt;int&gt; &amp;action_idx)<span class="keyword"> const override </span>{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Get constant values from SE3Pose</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">double</span> z = curr.position[2]; <span class="comment">// Z coordinate.</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">double</span> yaw = curr.<a class="code" href="structnx_1_1SE3Pose.html#a103674ebbf5d7e62b9ead5131bbdd289">getYaw</a>();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">double</span> pitch = curr.<a class="code" href="structnx_1_1SE3Pose.html#a98a2f187d971144630219e2f6a989f55">getPitch</a>();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">double</span> roll = curr.<a class="code" href="structnx_1_1SE3Pose.html#afe22fcd642b968043a5e8ef1d284ee39">getRoll</a>();</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">size_t</span> num_traj = mprim_.size();</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//size_t len_traj = mprim_[0].xVecVec.size();</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">//size_t len_traj_fine = mprim_[0].(*mp_x_ptr_)[0].size();</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">//size_t num_samp_vals = len_traj_fine / len_traj;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">double</span> min_x = map-&gt;min()[0];</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">double</span> res_x = map-&gt;res()[0];</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">int</span> sz_x = map-&gt;size()[0];</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">double</span> min_y = map-&gt;min()[1];</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">double</span> res_y = map-&gt;res()[1];</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> sz_y = map-&gt;size()[1];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Reserve space for successors</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    succ.reserve(num_traj * max_len_traj_);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    succ_idx.reserve(num_traj * max_len_traj_);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    succ_cost.reserve(num_traj * max_len_traj_);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    action_idx.reserve(num_traj * max_len_traj_);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> tr = 0; tr &lt; num_traj; ++tr) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">// Get current cell Theta</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordtype">double</span> theta = curr.<a class="code" href="structnx_1_1SE3Pose.html#a103674ebbf5d7e62b9ead5131bbdd289">getYaw</a>();</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordtype">int</span> cell_theta = nx::meters2cells(theta, -PI, yaw_res);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//                std::cout &lt;&lt;&quot;Double theta: &quot; &lt;&lt; theta &lt;&lt; std::endl;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//                std::cout &lt;&lt;&quot;Cell theta: &quot; &lt;&lt; cell_theta &lt;&lt; std::endl;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      std::vector&lt;int&gt; cell = map-&gt;meters2cells({curr.position[0], curr.position[1], curr.position[2]});</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordtype">size_t</span> len_traj = mprim_xd_[cell_theta][tr].size();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> len = 0; len &lt; len_traj; ++len) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">// check for collisions along the microstates</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">bool</span> collided = <span class="keyword">false</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len_fine_sz = mprim_xd_[cell_theta][tr][len].size();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len_fine = 0; len_fine &lt; len_fine_sz; ++len_fine) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <span class="keywordtype">int</span> x_val = cell[0] + mprim_xd_[cell_theta][tr][len][len_fine][0];</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          <span class="keywordtype">int</span> y_val = cell[1] + mprim_xd_[cell_theta][tr][len][len_fine][1];</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordtype">int</span> z_val = cell[2];</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="comment">//int q_val = mprim_xd_[curr[2]][tr][len][len_fine][2];</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <span class="comment">// Discard motion primitives that go outside of the map</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">if</span> (x_val &lt; 0 || x_val &gt;= sz_x ||</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              y_val &lt; 0 || y_val &gt;= sz_y) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            collided = <span class="keyword">true</span>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="comment">// Discard motion primitives that collide</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordtype">int</span> lindix;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <span class="keywordflow">if</span> (is_3d) <span class="comment">// If the map is 3D, we check 3D space for collisions.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            lindix = map-&gt;subv2ind_colmajor({x_val, y_val, z_val});</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            lindix = map-&gt;subv2ind_colmajor({x_val, y_val});</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordflow">if</span> (cmap_-&gt;at(lindix)) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">//std::cout &lt;&lt; &quot; Collided\n&quot;;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            collided = <span class="keyword">true</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="keywordflow">if</span> (len_fine == len_fine_sz - 1) <span class="comment">// The end of the fine trajectory</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordtype">int</span> q_val = mprim_xd_[cell_theta][tr][len][len_fine][2];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            std::vector&lt;double&gt; meters = map-&gt;cells2meters({x_val, y_val});</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordtype">double</span> new_yaw = nx::cells2meters(q_val, -PI, yaw_res);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//                            std::cout &lt;&lt;&quot;New qval &quot; &lt;&lt; q_val &lt;&lt; std::endl;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//                            std::cout &lt;&lt;&quot;New yaw: &quot; &lt;&lt; new_yaw &lt;&lt; std::endl;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            Vector3d new_position({meters[0], meters[1], z});</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">double</span> yaw_change = restrict_angle(new_yaw - yaw);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            Matrix3d rotation = rotz(yaw_change);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            Matrix3d new_orientation = curr.orientation * rotation;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            succ.push_back(<a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a>(new_position, new_orientation));</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            succ_idx.push_back(lindix);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            succ_cost.push_back(mprim_[tr].cVec[len]);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            action_idx.push_back(tr * max_len_traj_ + len);  <span class="comment">// action_id</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// No need to check the rest of the trajectory length if we collided already</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> (collided)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classnx_1_1SE2Environment.html#ac9453c2a57e53c9f511eb04aabaa0809">  196</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classnx_1_1SE2Environment.html#ac9453c2a57e53c9f511eb04aabaa0809">forward_action</a>(<span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp;curr, <span class="keywordtype">int</span> action_id,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                      std::vector&lt;SE3Pose&gt; &amp;next_micro)<span class="keyword"> const override </span>{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Get current cell Theta</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">double</span> theta = curr.<a class="code" href="structnx_1_1SE3Pose.html#a103674ebbf5d7e62b9ead5131bbdd289">getYaw</a>();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> cell_theta = nx::meters2cells(theta, -PI, yaw_res);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    std::vector&lt;int&gt; cell = map-&gt;meters2cells({curr.position[0], curr.position[1]});</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">//    std::cout &lt;&lt;&quot; Coord&quot;  &lt;&lt; curr[0] &lt;&lt; &quot; &quot; &lt;&lt; curr[1] &lt;&lt; &quot; &quot; &lt;&lt; curr[2] &lt;&lt;  std::endl;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">size_t</span> num_traj = mprim_.size();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">//size_t len_traj_fine = mprim_[0].(*mp_x_ptr_)[0].size();</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">//size_t num_samp_vals = len_traj_fine / len_traj;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// find which trajectory it is</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">size_t</span> tr = action_id / max_len_traj_;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">size_t</span> len_sz = action_id % max_len_traj_;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> len = 0; len &lt;= len_sz; ++len) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordtype">size_t</span> len_fine_sz = mprim_xd_[cell_theta][tr][len].size();</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> len_fine = 0; len_fine &lt; len_fine_sz; ++len_fine) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">int</span> x_val = cell[0] + mprim_xd_[cell_theta][tr][len][len_fine][0];</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordtype">int</span> y_val = cell[1] + mprim_xd_[cell_theta][tr][len][len_fine][1];</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordtype">int</span> q_val = mprim_xd_[cell_theta][tr][len][len_fine][2];</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (len_fine == len_fine_sz - 1) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="comment">// Construct the new SE3Pose</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          std::vector&lt;double&gt; meters = map-&gt;cells2meters({x_val, y_val});</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="keywordtype">double</span> new_yaw = nx::cells2meters(q_val, -PI, yaw_res);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          Vector3d new_position({meters[0], meters[1], curr.position[2]});</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keywordtype">double</span> yaw_change = restrict_angle(new_yaw - curr.<a class="code" href="structnx_1_1SE3Pose.html#a103674ebbf5d7e62b9ead5131bbdd289">getYaw</a>());</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          Matrix3d rotation = rotz(yaw_change);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          Matrix3d new_orientation = rotation * curr.orientation;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          next_micro.push_back(<a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a>(new_position, new_orientation));</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">//int x_val = nx::meters2cells( nx::cells2meters( curr[0], MAP_ptr-&gt;min()[0], MAP_ptr-&gt;res()[0] )</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">//  + (*mprim_[tr].mp_x_ptr)[len][len_fine].first, MAP_ptr-&gt;min()[0], MAP_ptr-&gt;res()[0]);</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">//int y_val = nx::meters2cells( nx::cells2meters( curr[1], MAP_ptr-&gt;min()[1], MAP_ptr-&gt;res()[1] )</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">//  + (*mprim_[tr].mp_x_ptr)[len][len_fine].second, MAP_ptr-&gt;min()[1], MAP_ptr-&gt;res()[1]);</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">void</span> init_mprim_xd_() {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">double</span> x, y, q;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">int</span> xc, yc, qc;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">int</span> theta_sz = (yaw_discretization_size);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    mprim_xd_.resize(theta_sz);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">int</span> num_prim = mprim_.size();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; theta_sz; ++k) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      mprim_xd_[k].resize(num_prim);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordtype">double</span> ori = nx::cells2meters(k, -PI, yaw_res);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> pr = 0; pr &lt; num_prim; ++pr) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordtype">int</span> num_seg = mprim_[pr].xVecVec.size();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        mprim_xd_[k][pr].resize(num_seg);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> seg = 0; seg &lt; num_seg; ++seg) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keywordtype">int</span> num_sta = mprim_[pr].xVecVec[seg].size();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> st = 0; st &lt; num_sta; ++st) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            nx::smart_plus_SE2(map-&gt;origin()[0], map-&gt;origin()[1], ori,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                               mprim_[pr].xVecVec[seg][st][0],</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                               mprim_[pr].xVecVec[seg][st][1],</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                               mprim_[pr].xVecVec[seg][st][2],</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                               x, y, q);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            xc = nx::meters2cells(x, map-&gt;min()[0], map-&gt;res()[0])</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                - map-&gt;origincells()[0];</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            yc = nx::meters2cells(y, map-&gt;min()[1], map-&gt;res()[1])</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                - map-&gt;origincells()[1];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            qc = nx::meters2cells(q, -PI, yaw_res);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">// add only if unique</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">if</span> (mprim_xd_[k][pr][seg].empty() ||</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                xc != mprim_xd_[k][pr][seg].back()[0] ||</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                yc != mprim_xd_[k][pr][seg].back()[1] ||</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                qc != mprim_xd_[k][pr][seg].back()[2])</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              mprim_xd_[k][pr][seg].push_back({xc, yc, qc});</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  } <span class="comment">// End function</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">double</span> ComputeStateMetric(<span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp;s1 , <span class="keyword">const</span> <a class="code" href="structnx_1_1SE3Pose.html">SE3Pose</a> &amp; s2)<span class="keyword"> const override</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// First project into SE3</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    Vector3d s1_se2 = s1.<a class="code" href="structnx_1_1SE3Pose.html#a1796e8aafcf90da2e6b0d07ca4c7135f">getSE2</a>();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    Vector3d s2_se2 = s2.<a class="code" href="structnx_1_1SE3Pose.html#a1796e8aafcf90da2e6b0d07ca4c7135f">getSE2</a>();</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    Vector3d state_diff = s1_se2 - s2_se2;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    state_diff(2, 0) = nx::restrict_angle(state_diff(2, 0)); <span class="comment">// Wrap Angle</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    Vector4d state_diff_c; <span class="comment">// Complex numbers for angle</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    state_diff_c &lt;&lt; state_diff(0, 0),</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        state_diff(1, 0),</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        std::cos(state_diff(2, 0)),</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        std::sin(state_diff(2, 0));</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> state_diff_c.norm();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  };</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}; <span class="comment">// End class</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;} <span class="comment">// End namespace</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#endif //NX_ASTAR_ENV_TARGET_SE2_H</span></div><div class="ttc" id="structnx_1_1MotionPrimitive_html"><div class="ttname"><a href="structnx_1_1MotionPrimitive.html">nx::MotionPrimitive</a></div><div class="ttdef"><b>Definition:</b> motion_primitive.h:12</div></div>
<div class="ttc" id="structnx_1_1SE3Pose_html_afe22fcd642b968043a5e8ef1d284ee39"><div class="ttname"><a href="structnx_1_1SE3Pose.html#afe22fcd642b968043a5e8ef1d284ee39">nx::SE3Pose::getRoll</a></div><div class="ttdeci">double getRoll() const</div><div class="ttdef"><b>Definition:</b> se3_pose.h:80</div></div>
<div class="ttc" id="classnx_1_1SE2Environment_html_a0fe7c5f438795a98f17be0ed95b2ff7c"><div class="ttname"><a href="classnx_1_1SE2Environment.html#a0fe7c5f438795a98f17be0ed95b2ff7c">nx::SE2Environment::state_to_idx</a></div><div class="ttdeci">int state_to_idx(const SE3Pose &amp;state) const override</div><div class="ttdef"><b>Definition:</b> env_se2.h:78</div></div>
<div class="ttc" id="classnx_1_1SE2Environment_html_ac9453c2a57e53c9f511eb04aabaa0809"><div class="ttname"><a href="classnx_1_1SE2Environment.html#ac9453c2a57e53c9f511eb04aabaa0809">nx::SE2Environment::forward_action</a></div><div class="ttdeci">void forward_action(const SE3Pose &amp;curr, int action_id, std::vector&lt; SE3Pose &gt; &amp;next_micro) const override</div><div class="ttdef"><b>Definition:</b> env_se2.h:196</div></div>
<div class="ttc" id="classnx_1_1Environment_html_a23652067c6e2c838b7e895ada850fa6b"><div class="ttname"><a href="classnx_1_1Environment.html#a23652067c6e2c838b7e895ada850fa6b">nx::Environment&lt; SE3Pose &gt;::Environment</a></div><div class="ttdeci">Environment(std::shared_ptr&lt; nx::map_nd &gt; map_in, std::shared_ptr&lt; std::vector&lt; char &gt;&gt; cmap, SE3Pose goal=SE3Pose())</div><div class="ttdef"><b>Definition:</b> env_int.h:33</div></div>
<div class="ttc" id="structnx_1_1SE3Pose_html_a98a2f187d971144630219e2f6a989f55"><div class="ttname"><a href="structnx_1_1SE3Pose.html#a98a2f187d971144630219e2f6a989f55">nx::SE3Pose::getPitch</a></div><div class="ttdeci">double getPitch() const</div><div class="ttdef"><b>Definition:</b> se3_pose.h:72</div></div>
<div class="ttc" id="classnx_1_1SE2Environment_html"><div class="ttname"><a href="classnx_1_1SE2Environment.html">nx::SE2Environment</a></div><div class="ttdef"><b>Definition:</b> env_se2.h:19</div></div>
<div class="ttc" id="classnx_1_1SE2Environment_html_ab1f9056e6fffe905ec225ee3885679b4"><div class="ttname"><a href="classnx_1_1SE2Environment.html#ab1f9056e6fffe905ec225ee3885679b4">nx::SE2Environment::state_to_SE2</a></div><div class="ttdeci">Vector3d state_to_SE2(const SE3Pose &amp;state) const override</div><div class="ttdef"><b>Definition:</b> env_se2.h:85</div></div>
<div class="ttc" id="structnx_1_1SE3Pose_html"><div class="ttname"><a href="structnx_1_1SE3Pose.html">nx::SE3Pose</a></div><div class="ttdef"><b>Definition:</b> se3_pose.h:20</div></div>
<div class="ttc" id="structnx_1_1SE3Pose_html_a1796e8aafcf90da2e6b0d07ca4c7135f"><div class="ttname"><a href="structnx_1_1SE3Pose.html#a1796e8aafcf90da2e6b0d07ca4c7135f">nx::SE3Pose::getSE2</a></div><div class="ttdeci">Vector3d getSE2() const</div><div class="ttdef"><b>Definition:</b> se3_pose.h:88</div></div>
<div class="ttc" id="namespacenx_html"><div class="ttname"><a href="namespacenx.html">nx</a></div><div class="ttdef"><b>Definition:</b> dd_motion_model.h:7</div></div>
<div class="ttc" id="classnx_1_1Environment_html"><div class="ttname"><a href="classnx_1_1Environment.html">nx::Environment</a></div><div class="ttdef"><b>Definition:</b> env_int.h:18</div></div>
<div class="ttc" id="classnx_1_1SE2Environment_html_ae3ac780e46d421898e3c7db696d8026f"><div class="ttname"><a href="classnx_1_1SE2Environment.html#ae3ac780e46d421898e3c7db696d8026f">nx::SE2Environment::state_to_cell</a></div><div class="ttdeci">std::vector&lt; int &gt; state_to_cell(const SE3Pose &amp;state) const override</div><div class="ttdef"><b>Definition:</b> env_se2.h:89</div></div>
<div class="ttc" id="classnx_1_1SE2Environment_html_a2a4159dc6bf024e522bb504c77e9aa69"><div class="ttname"><a href="classnx_1_1SE2Environment.html#a2a4159dc6bf024e522bb504c77e9aa69">nx::SE2Environment::get_succ</a></div><div class="ttdeci">void get_succ(const SE3Pose &amp;curr, std::vector&lt; SE3Pose &gt; &amp;succ, std::vector&lt; int &gt; &amp;succ_idx, std::vector&lt; double &gt; &amp;succ_cost, std::vector&lt; int &gt; &amp;action_idx) const override</div><div class="ttdef"><b>Definition:</b> env_se2.h:94</div></div>
<div class="ttc" id="structnx_1_1SE3Pose_html_a103674ebbf5d7e62b9ead5131bbdd289"><div class="ttname"><a href="structnx_1_1SE3Pose.html#a103674ebbf5d7e62b9ead5131bbdd289">nx::SE3Pose::getYaw</a></div><div class="ttdeci">double getYaw() const</div><div class="ttdef"><b>Definition:</b> se3_pose.h:64</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
